<!doctype html>
<html lang="es" data-bs-theme="auto">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tomates ‚Ä¢ Dashboard U6</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg border-bottom px-3">
      <div class="container-fluid">
        <span class="navbar-brand fw-semibold">üçÖ Dashboard Tomates (EDA)</span>
        <div class="d-flex gap-2 ms-auto align-items-center">
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="themeSwitch">
            <label class="form-check-label" for="themeSwitch">üåô/‚òÄÔ∏è</label>
          </div>
          <button class="btn btn-primary" id="btnReload">üîÑ Recalcular</button>
        </div>
      </div>
    </nav>

    <main class="container py-3">

      <!-- Carga local -->
      <section class="row g-3 align-items-end">
        <div class="col-12 col-lg-6">
          <label class="form-label">Cargar base local (CSV)</label>
          <input type="file" class="form-control" id="fileInput" accept=".csv" />
          <div class="form-text">Eleg√≠ <code>tomates_calidad.csv</code>. Nada se sube a internet.</div>
        </div>

        <div class="col-12 col-lg-6">
          <div class="row g-2">
            <div class="col-6 col-md-3">
              <label class="form-label">Turno</label>
              <select class="form-select" id="fTurno">
                <option value="all" selected>Todos</option>
                <option value="Ma√±ana">Ma√±ana</option>
                <option value="Tarde">Tarde</option>
              </select>
            </div>
            <div class="col-6 col-md-3">
              <label class="form-label">Proveedor</label>
              <select class="form-select" id="fProv">
                <option value="all" selected>Todos</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
              </select>
            </div>
            <div class="col-6 col-md-3">
              <label class="form-label">Calidad</label>
              <select class="form-select" id="fCal">
                <option value="all" selected>Todos</option>
                <option value="Extra">Extra</option>
                <option value="I">I</option>
                <option value="II">II</option>
              </select>
            </div>
            <div class="col-6 col-md-3">
              <label class="form-label">Defecto</label>
              <select class="form-select" id="fDef">
                <option value="all" selected>Todos</option>
                <option value="S√≠">S√≠</option>
                <option value="No">No</option>
              </select>
            </div>
          </div>
        </div>
      </section>

      <!-- Summary cards -->
      <section class="row g-3 my-3" id="summaryCards">
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">N (tomates)</div>
              <div class="fs-4 fw-bold" id="cardN">‚Äì</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">% Defectos</div>
              <div class="fs-4 fw-bold" id="cardDefPct">‚Äì</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">Media peso (g)</div>
              <div class="fs-5 fw-bold" id="cardPesoMean">‚Äì</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">Varianza peso (g¬≤)</div>
              <div class="fs-6 fw-bold" id="cardPesoVar">‚Äì</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">Media di√°metro (mm)</div>
              <div class="fs-5 fw-bold" id="cardDiaMean">‚Äì</div>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="card shadow-sm h-100">
            <div class="card-body">
              <div class="text-muted small">Varianza di√°metro (mm¬≤)</div>
              <div class="fs-6 fw-bold" id="cardDiaVar">‚Äì</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Cualitativas -->
      <section class="my-3">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h6 class="card-title">Frecuencias por turno</h6>
                <canvas id="chartTurno"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h6 class="card-title">Proporci√≥n de categor√≠as de calidad</h6>
                <canvas id="chartCalidad"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h6 class="card-title">Frecuencias por proveedor</h6>
                <canvas id="chartProv"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h6 class="card-title">Defectos (S√≠/No)</h6>
                <canvas id="chartDefecto"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Cuantitativas -->
      <section class="my-3">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="card-title">Histograma di√°metro (mm)</h6>
                <canvas id="histDiametro"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="card-title">Histograma peso (g)</h6>
                <canvas id="histPeso"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Relaci√≥n lineal -->
      <section class="my-3">
        <div class="card shadow-sm">
          <div class="card-body">
            <h6 class="card-title">Peso vs di√°metro (scatter + recta)</h6>
            <canvas id="scatterPesoDiam"></canvas>
          </div>
        </div>
      </section>

      <!-- Tabla -->
      <section class="my-3">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
              <h6 class="card-title m-0">Datos filtrados</h6>
              <button class="btn btn-outline-primary btn-sm" id="btnExport">‚¨áÔ∏è Export CSV (filtrado)</button>
            </div>
            <div class="table-responsive mt-2">
              <table class="table table-sm align-middle" id="tblData">
                <thead>
                  <tr>
                    <th>ID</th><th>Fecha</th><th>Turno</th><th>Proveedor</th>
                    <th>Calidad</th><th>Defecto</th><th>Di√°m (mm)</th>
                    <th>Peso (g)</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="form-text">Tip: pod√©s ordenar/filtrar en Python usando el mismo CSV.</div>
          </div>
        </div>
      </section>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="./app.js"></script>
  </body>
</html>
